# 如何将一个集成系统分解成微服务

## 解耦什么，何时解耦
*当一个集成系统变得很大难以处理时，很多公司都会被把系统分解成微服务样式所吸引。这是一个值得却不是很容易的开发旅程。我们已经学习到，做好这些，我们需要从一个简单的服务开始，但是之后，提取基于垂直能力的服务，对于经常变化的业务和主题很重要。这些服务开始应该很大，最好不依赖剩下的继承服务。我们应该确保每一步迁移都表示成体架构的原子性改进。*  
将一个集成系统迁移到微服务生态系统是个史诗性的旅程。从事这个旅程的人会有一些愿望，例如提高操作的规模，加速变化的步伐以及远离变化的高代价。他们希望增加团队数量，同时能够使他们并行独立的相互传递数据。他们希望快速的尝试业务的核心功能，并且更快的传递数据。他们还希望避免与更改现有集成系统相关的高成本。  
决定何时如何逐步迁移的能力是将一个集成系统分解成微服务生态的一些架构挑战。在这篇文章中，我分享了一些技术，能够指导交付团队-开发人员，架构师，技术经理-在这个旅程中作出这些分解决策。  
我使用一个多层在线零售应用来阐述这些技术。这个应用能够紧密的结合用户界面，业务逻辑和数据层。我之所以选择这个例子，是因为它的架构具有需要商业运行的集成应用的特点，而且它的技术栈足够现代，能证明的分解比完全重写和替代合理。
## 微服务生态定义
在开始着手之前，每个人对微服务生态系统有个大概了解是很重要的。微服务生态系统是一个服务平台，每个服务都封装了一个业务能力。一个业务能力表示一个业务在特定领域能够满足目标以及职责所做的事情。每个微服务都公开了一个API,开发者可以以自主的方式发现使用它。微服务有独立的生命周期。开发者可以独立的建立，测试以及发布每个微服务。 微服务生态系统强制一个自主长期团队的组织结构，每个天对负责一个或多个服务。与一般认知和微服务中“微”相反，每个服务的大小至关重要，可能会根据组织的运营成熟度有所不同。就像 Martin Fowler说的：微服务只是标志，不是描述。  
![微服务生态](./images/2019041601/ecosystem.svg)  
*图片1:服务封通过自主API装了业务能力，暴露数据和功能*  
## 旅程指导
在深入这个指导之前，了解将一个存在的集成系统分解成微服务有很高的代价，以及需要很多迭代是很重要的。对于开发者和架构师来说，紧密的评估是否将一个存在的集成系统分解是个正确的方法，以及微服务本身是否是正确的目标，是很有必要的。这些弄清楚后，我们可以开始这个指导。
### 通过一个简单以及相当解耦的能力热身
开始一个微服务道路需要一个最小等级的操作准备。它需要按需访问部署环境，构建新的可持续交付的管道，用来独立的构建，测试以及部署可执行服务，以及保护，调试和监视分布式体系结构的能力。无论是构建greenfiled服务还是分解一个现有的系统，都需要业务准备完成。了解更多关于业务准备可以查看Martin Fowler关于微服务先修的文章。好消息是自从Martin的文章后，操作微服务架构的技术已经迅速进化。包括Service Mesh,一个让微服务网络更快，更可靠以及安全的专用基础设施层，容器编排系统，能够提供更高级别的部署架构抽象，以及像GoCD这种作为容器的构建，测试，部署微服务的持续分发系统得发展。